# Diffieâ€“Hellman Lab â€” Project README

This project implements a complete **Diffieâ€“Hellman Key Exchange** system using:

- **C code (`myProg.c`) for modular exponentiation**
- **WebAssembly (WASM) compiled by Emscripten**
- **A Node.js backend server**
- **A browser client UI** that matches the PDF instructions exactly
- **Auto fallback JavaScript modexp** if WASM fails or isnâ€™t compiled

This README contains everything needed to **run**, **compile**, and **debug** the full system.

---

## ğŸ“ Project Structure

```
diffie_final_project/
â”‚
â”œâ”€â”€ server.js
â”œâ”€â”€ package.json
â”œâ”€â”€ myProg.c                    (your original unchanged C code)
â”œâ”€â”€ build_wasm_and_place.ps1    (optional oneâ€‘click WASM build script)
â”‚
â””â”€â”€ public/
    â”œâ”€â”€ index.html              (UI identical to PDF)
    â”œâ”€â”€ myprog.js               (generated by Emscripten)
    â”œâ”€â”€ myprog.wasm             (generated by Emscripten)
    â””â”€â”€ myprog_fallback.js      (JS fallback modular exponentiation)
```

---

## ğŸš€ Running Without Emscripten (Immediate)

You can run the full project instantly **even without WASM**.

In terminal:

```bat
npm install
node server.js
```

Then open:

```
http://localhost:8080
```

Click **Load myprog.js** â†’ Client loads fallback automatically  
Click **Compute & Send** â†’ Full DH flow works.

---

## ğŸ› ï¸ Building the Real WASM Version

If you want to use your C code through WebAssembly (required by assignment):

### 1. Activate Emscripten:

```bat
cd C:\emsdk
emsdk_env.bat
```

### 2. Go to project folder:

```bat
cd C:\path	o\diffie_final_project
```

### 3. Compile to WASM:

```bat
emcc myProg.c -O3 -s WASM=1 -s MODULARIZE=1 -s EXPORT_NAME="myprog" ^
  -s EXPORTED_FUNCTIONS="['_modexp']" ^
  -s EXPORTED_RUNTIME_METHODS="['ccall','cwrap']" ^
  -o public\myprog.js
```

This creates:

```
public/myprog.js
public/myprog.wasm
```

### 4. Restart server:

```bat
node server.js
```

### 5. Browser â†’ Click **Load myprog.js**

You should see:

```
WASM status: loaded (Module)
```

---

## ğŸ’¬ API Flow (Matches PDF)

### Client:
- Inputs: `p`, `g`
- Random `a`
- Computes `x = g^a mod p`
- Sends `{ g, p, x }` â†’ server

### Server:
- Random `b`
- Computes:
  - `y = g^b mod p`
  - `K = x^b mod p` (shared secret)
- Returns `{ K, y, b }` â†’ client

---

## âš ï¸ Troubleshooting

### Check if compiled files exist:

```bat
dir public\myprog.js public\myprog.wasm
```

### Check server status:

```bat
curl http://localhost:8080/wasm-status
```

### Check if myprog.js is reachable:

```bat
curl -I http://localhost:8080/myprog.js
```

### Port 8080 busy?

```bat
netstat -ano | findstr :8080
taskkill /PID <pid> /F
```

### Browser says â€œClient wasm not loadedâ€?

In DevTools Console:

```js
typeof Module
typeof Module.cwrap
typeof window._modexp_js
```

If fallback loaded â†’ `window._modexp_js` will be a function.

---

## âœ”ï¸ Summary

- The client/server code follows the PDF exactly.
- `myProg.c` is never modified.
- WASM is optional thanks to fallback.
- The UI and backend are fully implemented.
- Compiling with Emscripten enables real C execution in browser + Node.

---

If you want, I can also generate:

- ZIP of entire project  
- PDF version of README  
- Step-by-step installation guide with screenshots  

Just tell me! ğŸ˜Š
